<!DOCTYPE html>
<html>
<head>
<title>Tute Pixel Loader</title>
<style>
    body {
        margin: 0;
        background: #000;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        overflow: hidden;
    }

    #stage {
        position: relative;
        width: 500px;
        height: 500px;
        overflow: visible;
    }

    .pixel {
        position: absolute;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        transition: transform 1s, box-shadow 1s;
    }

    canvas {
        display: none;
    }
</style>
</head>
<body>

<canvas id="canvas"></canvas>
<div id="stage"></div>

<script>
const img = new Image();
img.src = "tute.png"; // your logo

img.onload = () => {
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const stage = document.getElementById("stage");

    canvas.width = img.width;
    canvas.height = img.height;

    // 1️⃣ Draw logo and collect logo particles
    ctx.drawImage(img, 0, 0);
    const logoData = ctx.getImageData(0, 0, img.width, img.height).data;

    const step = 10;
    const particles = [];

    for (let y = 0; y < img.height; y += step) {
        for (let x = 0; x < img.width; x += step) {
            const i = (y * img.width + x) * 4;
            if (logoData[i + 3] > 50) {
                const px = document.createElement("div");
                px.className = "pixel";
                px.style.background = rgb(${logoData[i]},${logoData[i+1]},${logoData[i+2]});
                px.style.left = x + "px";
                px.style.top = y + "px";
                stage.appendChild(px);

                particles.push({ 
                    px, x, y, 
                    colorR: logoData[i], 
                    colorG: logoData[i+1], 
                    colorB: logoData[i+2] 
                });
            }
        }
    }

    // 2️⃣ Create TUTE text map
    ctx.clearRect(0, 0, img.width, img.height);
    ctx.font = "bold 200px Arial";
    ctx.textAlign = "center";
    ctx.fillStyle = "#fff";
    ctx.fillText("TUTE", img.width / 2, img.height / 2 + 50);

    const textData = ctx.getImageData(0, 0, img.width, img.height).data;
    const textPoints = [];

    for (let y = 0; y < img.height; y += step) {
        for (let x = 0; x < img.width; x += step) {
            const i = (y * img.width + x) * 4;
            if (textData[i + 3] > 50) {
                textPoints.push({ x, y });
            }
        }
    }

    // Assign closest TUTE spot (cycling if not enough)
    particles.forEach((p, i) => {
        const target = textPoints[i % textPoints.length];
        p.textX = target.x;
        p.textY = target.y;
    });

    // 3️⃣ Glow helper
    function setGlow(p, intensity = 0.8) {
        const r = Math.min(255, p.colorR * intensity);
        const g = Math.min(255, p.colorG * intensity);
        const b = Math.min(255, p.colorB * intensity);
        p.px.style.boxShadow = 0 0 12px rgb(${r},${g},${b});
    }

    function pulseGlow(particles, min = 0.6, max = 1.2, speed = 1000) {
        let growing = true;
        let intensity = min;

        const interval = setInterval(() => {
            particles.forEach(p => setGlow(p, intensity));

            if (growing) {
                intensity += 0.05;
                if (intensity >= max) growing = false;
            } else {
                intensity -= 0.05;
                if (intensity <= min) growing = true;
            }
        }, speed / ((max - min) / 0.05));

        return interval;
    }

    // 4️⃣ Animation: explode → TUTE → return to logo
    function explode() {
        particles.forEach(p => {
            const angle = Math.random() * Math.PI * 2;
            const dist = 150 + Math.random() * 200;
            p.px.style.transition = "1.5s ease-out";
            p.px.style.transform = translate(${Math.cos(angle)*dist}px, ${Math.sin(angle)*dist}px);
        });
    }

    function formTute() {
        particles.forEach(p => {
            const dx = p.textX - p.x;
            const dy = p.textY - p.y;
            p.px.style.transition = "2s ease-in-out";
            p.px.style.transform = translate(${dx}px, ${dy}px);
        });
    }

    function backToLogo() {
        particles.forEach(p => {
            p.px.style.transition = "2s ease-in-out";
            p.px.style.transform = translate(0px,0px);
        });
    }

    // 5️⃣ Run animations with pulsing glow
    const glowInterval = pulseGlow(particles, 0.6, 1.2, 80);

    setTimeout(explode, 600);
    setTimeout(formTute, 2600);
    setTimeout(backToLogo, 6000);

    // Optional: stop glow after everything settles
    setTimeout(() => clearInterval(glowInterval), 9000);
};
</script>

</body>
</html>